

<html> 
<head> 
<title>Karel Reader</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<script src="../../plugins/jquery.min.js"></script>

<link rel="stylesheet"  href="../../plugins/bootstrap/css/bootstrap.min.css">
<script src="../../plugins/bootstrap/js/bootstrap.min.js"></script>

<link rel="stylesheet" href="../../style.css">

<script src="../..//karel/js/html/websiteImports.js"></script>
<script>importCss();</script>
<script>importJs();</script>
</head> 
<body>
  <!-- container -->
  <div class="bookContainer">
<!-- side bar -->
<div class="bookSideBar">
  <div class="homeLink">
    <a href="../../java/en/intro.html">
      <span class="glyphicon glyphicon-home" aria-hidden="true"></span>
      Karel
    </a>
  </div>
  <hr/>
  
  <div class="chapterTab" onclick="location.href='../../java/en/chapter1.html'">
    <a class="bookLink btn btn-link" href="../../java/en/chapter1.html">
      1 - Meet Karel
    </a>
  </div>
  <div class="chapterTab" onclick="location.href='../../java/en/chapter2.html'">
    <a class="bookLink btn btn-link" href="../../java/en/chapter2.html">2 - Programming</a>
  </div>
  <div class="chapterTab" onclick="location.href='../../java/en/chapter3.html'">
    <a class="bookLink btn btn-link" href="../../java/en/chapter3.html">3 - New Methods</a>
  </div>
  <div class="chapterTab" onclick="location.href='../../java/en/chapter4.html'">
    <a class="bookLink btn btn-link" href="../../java/en/chapter4.html">4 - Decomposition</a>
  </div>
  <div class="chapterTab" onclick="location.href='../../java/en/chapter5.html'">
    <a class="bookLink btn btn-link" href="../../java/en/chapter5.html">5 - For Loops</a>
  </div>
  <div class="chapterTab" onclick="location.href='../../java/en/chapter6.html'">
    <a class="bookLink btn btn-link" href="../../java/en/chapter6.html">6 - While Loops</a>
  </div>
  <div class="chapterTab" onclick="location.href='../../java/en/chapter7.html'">
    <a class="bookLink btn btn-link" href="../../java/en/chapter7.html">7 - Conditionals</a>
  </div>
  <div class="chapterTab" onclick="location.href='../../java/en/chapter8.html'">
    <a class="bookLink btn btn-link" href="../../java/en/chapter8.html">8 - Refinement</a>
  </div>
  <div class="chapterTab" onclick="location.href='../../java/en/chapter9.html'">
    <a class="bookLink btn btn-link" href="../../java/en/chapter9.html">9 - SuperKarel</a>
  </div>

  <div class="chapterTab" onclick="location.href='../../java/en/reference.html'">
    <a class="bookLink btn btn-link" href="../../java/en/reference.html">10 - Reference</a>
  </div>

  <div class="chapterTab" onclick="location.href='../../java/en/ide.html'">
    <a class="bookLink btn btn-link" href="../../java/en/ide.html">11 - Code</a>
  </div>

  <hr/>

  <a href="../../"><img style = "width:40px" src="../../images/unFlag.png"/> Learn more</a> 

  <!-- <center>
    <img style ="width:75px;" src="../../images/stanford.png"/>
    </center> -->
</div>
    <!-- content -->
    <div class="bookContent" style="display: flex;">
      <!-- right gutter -->
      <div style="flex-grow:1;max-width:50px;"></div>

      <!-- main stuff -->
      <div class="" style="flex-basis:740px; max-width:740px; margin-left:20px; margin-right:20px">
      <div class="row">
        <div class="col-md-12 col-xs-12">

<h1>Chapter 6: While Loops</h1>
<hr/>
<p>
	The technique of defining new methods, and defining for loops—as useful as they are—does not actually enable Karel to solve any new problems. Every time you run a program it always does exactly the same thing. Programs become a lot more useful when they can respond differently to different inputs.
</p>

<p>
	As an example. Let's say you wanted to write a program to have Karel move to a wall. But you don't simply want this program to work on one world with a fixed size. You would like to write a single program that could work on any world.
</p>


<div class="section embeddedIde" id="moveToWall">
    <div id ='moveToWallIde' class = "ide getStarted" style="height:334.40000000000003px">
      <div id = 'moveToWallIdeCenter' class = "ideCenter" >
         <div id = 'moveToWallEditorDiv' class = 'ideEditorDiv' style="width:200px"></div>
         <div id = 'moveToWallCanvasDiv' class = 'ideCanvasDiv'>
            <div class="worldDropdown">

              <div class="dropdown">
                <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                  Change World
                  <span class="caret"></span>
                </button>
                <ul id="moveToWallWorlds" class="dropdown-menu" aria-labelledby="dropdownMenu1">
                  <li><a>1x1</a></li>
                  <li><a>4x4</a></li>
                  <li><a>3x6</a></li>
                  <li><a>7x7</a></li>
                  <li><a>8x8</a></li>
                </ul>
              </div>
            </div>
            <canvas id='moveToWallCanvas' class = 'ideCanvas'></canvas>
         </div>
      </div>
    </div>
    <div style="width:100%;">
        <div class="buttonBar">
           <button class="btn btn-default" id="moveToWallRunButton"><span class="glyphicon glyphicon-play"></span> Run Program</button>
        </div> 
    </div>
<script>

        

function examplemoveToWall() {
STARTER_CODE = `
/*
 * File: MoveToWall.java
 * ------------------------------
 * Uses a "while" loop to move Karel until it hits
 * a wall. Works on any sized world.
 */
import stanford.karel.*;
public class MoveToWall extends Karel {
   public void run() {
      moveToWall();
   }

   /* this is a very useful method */
   private void moveToWall() {
      while(frontIsClear()) {
         move();
      }
   } 
}`
// because of that extra endline at the start of the string
STARTER_CODE = STARTER_CODE.trim();

 var karelIde = null;
 var karelEditor = null;
 var buttonState = 'play';

 function main() {
   karelEditor = importEditorCode('moveToWallEditor','moveToWallEditorDiv', STARTER_CODE, false);
    setupWorldDropdown();
    
    
    var canvas = document.getElementById('moveToWallCanvas');
    karelIde = KarelIde('java',karelEditor, canvas, '7x7', 0.0, 'en');
    $('#moveToWallRunButton').click(function(){playClicked()});
    onresize();
    
 }

 function setupWorldDropdown() {
    console.log('setup world dropdown')
    let ul = document.getElementById('moveToWallWorlds')
    
    if (!ul.childNodes || ul.childNodes.length == 0) return;

    // Iterate LIs
    for (var itemi=0;itemi<ul.childNodes.length;itemi++) {
        var li = ul.childNodes[itemi];
        if(li.nodeName == "LI") {
          var a = li.childNodes[0]
          let worldName = a.innerHTML;
          console.log(worldName)
          a.onclick = () => setWorld(worldName);

        }
    }
 }

 function setWorld(worldName){
    console.log('here we go', worldName)
    karelIde.changeWorld(worldName)
    changeToPlayButton()
 }

 function playClicked() {
  if(buttonState == 'play') {
    karelIde.playButton();
    changeToResetButton();
   } else if (buttonState == 'reset') {
    karelIde.stopButton();
    changeToPlayButton();
   }
  }

  function changeToPlayButton() {
    var playText = '<span class="glyphicon glyphicon-play"></span> Run Program';
    $('#moveToWallRunButton').html(playText);
    buttonState = 'play';
  }

  function changeToResetButton() {
    var resetText = '<span class="glyphicon glyphicon-repeat"></span> Reset Program';
    $('#moveToWallRunButton').html(resetText);
    buttonState = 'reset';  
  }

 function onresize() { 
    var parentHeight = 334.40000000000003;
    var canvasWidth = 300
    var parentWidth = $("#moveToWall").width();
    console.log('pw: ' + parentWidth);

    var ide = document.getElementById('moveToWallIde');
    var editorDiv = document.getElementById('moveToWallEditorDiv');
    var canvas = document.getElementById('moveToWallCanvasDiv');
    
    var ideHeight = parentHeight
    var centerHeight = ideHeight;

    var availibleWidth = parentWidth;
    var elementSpacing = 12;

    var editorWidth = availibleWidth - canvasWidth - elementSpacing; 

    canvas.style.width = canvasWidth + 'px';
    canvas.style.height = canvasWidth + 'px';
    canvas.style.left = (editorWidth + elementSpacing) + 'px';



    editorDiv.style.left = 0 + 'px'
    editorDiv.style.width = editorWidth + 'px';
    editorDiv.style.height = parentHeight + 'px';
    console.log('editor width: ' + editorWidth)

    if (karelEditor) {
       karelEditor.renderer.onResize();
    }
 }
 main()
 
}
examplemoveToWall();
    </script>
</div>
<p>
	Try changing the world by clicking the "Change World" dropdown above the world. For any sized world, Karel will move until it hits a wall. Notice that this feat can not be acomplished using a <code class="keyword">for</code> loop. That would require us to know the size of the world at the time of programming.
	</p>

	<h3>Basic While Loop</h3>

<p>In Karel, a <code class="keyword">while</code> loop is used to repeat a body of code <i>as-long-as</i> a given condition holds. The while loop has the following general form:</p>
<p class="demoCode">
<code><span class="keyword">while</span>(</code><i class="demoText">test</i><code>){</code><br/>
   <i class="demoText" style="margin-left:2em">statements to be repeated</i><br/>
<code>}</code>
</p>



<p>
	The control-flow of a while loop is as follows. When the program hits a while loop it starts repeating a process where it first <i>checks</i> if the test passes, and if so <i>runs</i> the code in the body.
</p>
	When the program <i>checks</i> if the test passes, it decides if the <i class="demoText">test</i> is true for the current state of the world. If so, the loop will run the code in the body. If the test fails, the loop is over and the program moves on.
</p>
<p>
	When the program <i>runs</i> the body of the loop, the program executes the lines in the body one at a time. When the program arrives at the end of the while loop, it jumps back to the top of the loop. It then rechecks the test, continuing to loop if it passes. The program does not exit the loop until it gets to a check, and the test fails.
	</p>

	<p>
		Karel has many <i class="demoText">test</i> statements, and we will go over all of them in the next chapter. For now we are going to use a single test statement: <code>frontIsClear()</code> which is true if there is no wall directly infront of Karel.
	</p>

<h3>Fencepost Bug</h3>

<p>Let's modify our program above to make it more interesting. Instead of just moving to a wall, have Karel place a line of beepers, one in each square. Again we want this program to work for a world of any size:
</p>


<div class="section embeddedIde" id="beeperLineBug1">
    <div id ='beeperLineBug1Ide' class = "ide getStarted" style="height:352.0px">
      <div id = 'beeperLineBug1IdeCenter' class = "ideCenter" >
         <div id = 'beeperLineBug1EditorDiv' class = 'ideEditorDiv' style="width:200px"></div>
         <div id = 'beeperLineBug1CanvasDiv' class = 'ideCanvasDiv'>
            <div class="worldDropdown">

              <div class="dropdown">
                <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                  Change World
                  <span class="caret"></span>
                </button>
                <ul id="beeperLineBug1Worlds" class="dropdown-menu" aria-labelledby="dropdownMenu1">
                  <li><a>1x1</a></li>
                  <li><a>4x4</a></li>
                  <li><a>3x6</a></li>
                  <li><a>7x7</a></li>
                  <li><a>8x8</a></li>
                </ul>
              </div>
            </div>
            <canvas id='beeperLineBug1Canvas' class = 'ideCanvas'></canvas>
         </div>
      </div>
    </div>
    <div style="width:100%;">
        <div class="buttonBar">
           <button class="btn btn-default" id="beeperLineBug1RunButton"><span class="glyphicon glyphicon-play"></span> Run Program</button>
        </div> 
    </div>
<script>

        

function examplebeeperLineBug1() {
STARTER_CODE = `
/*
 * File: BeeperLineBug.java
 * ------------------------------
 * Uses a while loop to place a line of beepers.
 * This program works for a world of any size.
 * However, because each world requires one fewer
 * moves than putBeepers it always misses a beeper.
 */
import stanford.karel.*;
public class BeeperLineBug extends Karel {
   public void run() {
   	  /* repeats until karel faces a wall */
      while(frontIsClear()) {
      	 /* place a beeper on current square */ 
         putBeeper();
      	 /* move to the next square */
         move();
      }
   }
}`
// because of that extra endline at the start of the string
STARTER_CODE = STARTER_CODE.trim();

 var karelIde = null;
 var karelEditor = null;
 var buttonState = 'play';

 function main() {
   karelEditor = importEditorCode('beeperLineBug1Editor','beeperLineBug1EditorDiv', STARTER_CODE, true);
    setupWorldDropdown();
    
    
    var canvas = document.getElementById('beeperLineBug1Canvas');
    karelIde = KarelIde('java',karelEditor, canvas, '7x7', 0.0, 'en');
    $('#beeperLineBug1RunButton').click(function(){playClicked()});
    onresize();
    
 }

 function setupWorldDropdown() {
    console.log('setup world dropdown')
    let ul = document.getElementById('beeperLineBug1Worlds')
    
    if (!ul.childNodes || ul.childNodes.length == 0) return;

    // Iterate LIs
    for (var itemi=0;itemi<ul.childNodes.length;itemi++) {
        var li = ul.childNodes[itemi];
        if(li.nodeName == "LI") {
          var a = li.childNodes[0]
          let worldName = a.innerHTML;
          console.log(worldName)
          a.onclick = () => setWorld(worldName);

        }
    }
 }

 function setWorld(worldName){
    console.log('here we go', worldName)
    karelIde.changeWorld(worldName)
    changeToPlayButton()
 }

 function playClicked() {
  if(buttonState == 'play') {
    karelIde.playButton();
    changeToResetButton();
   } else if (buttonState == 'reset') {
    karelIde.stopButton();
    changeToPlayButton();
   }
  }

  function changeToPlayButton() {
    var playText = '<span class="glyphicon glyphicon-play"></span> Run Program';
    $('#beeperLineBug1RunButton').html(playText);
    buttonState = 'play';
  }

  function changeToResetButton() {
    var resetText = '<span class="glyphicon glyphicon-repeat"></span> Reset Program';
    $('#beeperLineBug1RunButton').html(resetText);
    buttonState = 'reset';  
  }

 function onresize() { 
    var parentHeight = 352.0;
    var canvasWidth = 300
    var parentWidth = $("#beeperLineBug1").width();
    console.log('pw: ' + parentWidth);

    var ide = document.getElementById('beeperLineBug1Ide');
    var editorDiv = document.getElementById('beeperLineBug1EditorDiv');
    var canvas = document.getElementById('beeperLineBug1CanvasDiv');
    
    var ideHeight = parentHeight
    var centerHeight = ideHeight;

    var availibleWidth = parentWidth;
    var elementSpacing = 12;

    var editorWidth = availibleWidth - canvasWidth - elementSpacing; 

    canvas.style.width = canvasWidth + 'px';
    canvas.style.height = canvasWidth + 'px';
    canvas.style.left = (editorWidth + elementSpacing) + 'px';



    editorDiv.style.left = 0 + 'px'
    editorDiv.style.width = editorWidth + 'px';
    editorDiv.style.height = parentHeight + 'px';
    console.log('editor width: ' + editorWidth)

    if (karelEditor) {
       karelEditor.renderer.onResize();
    }
 }
 main()
 
}
examplebeeperLineBug1();
    </script>
</div>
<p>That looks great. Except for one problem. On every world Karel doesn't place a beeper on the last square of the line (look closely). When Karel is on the last square, the program does not execute the body of the loop because the test no longer passes -- Karel is facing a wall. You might be tempted to try switching the order of the body so that Karel moves before placing a beeper. The code is editable so go try it!
	</p>

<p>
	There is a deeper problem that no rearrangement of the body can solve. For the world with 7 columns, Karel needs to put 7 beepers, but should only move 6 times. Since the while loop executes both lines when a test passes, how can you get the program to execute one command one more time than the other?
</p>

<p>
	The bug in this program is an example of a programming problem called a <b>fencepost error</b>. The name comes from the fact that if you want to build a fence made of panels which have one fence post on either side, the number of fence posts is always one greater than the number of panesl. How many fence posts, for example, do you need to build a fence with 10 panels? The answer is 11, as illustrated by the following diagram:
	</p>

<center>
<img style ="width:500px;margin-bottom:10px" src="../../images/ch6/fencepost.png"/>
</center>

<p>
	Once you discover it, fixing this bug is actually quite easy. Before Karel stops at the end of the world, all that the program has to do is place a final beeper:
</p>


<div class="section embeddedIde" id="beeperLine">
    <div id ='beeperLineIde' class = "ide getStarted" style="height:352.0px">
      <div id = 'beeperLineIdeCenter' class = "ideCenter" >
         <div id = 'beeperLineEditorDiv' class = 'ideEditorDiv' style="width:200px"></div>
         <div id = 'beeperLineCanvasDiv' class = 'ideCanvasDiv'>
            <div class="worldDropdown">

              <div class="dropdown">
                <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                  Change World
                  <span class="caret"></span>
                </button>
                <ul id="beeperLineWorlds" class="dropdown-menu" aria-labelledby="dropdownMenu1">
                  <li><a>1x1</a></li>
                  <li><a>4x4</a></li>
                  <li><a>3x6</a></li>
                  <li><a>7x7</a></li>
                  <li><a>8x8</a></li>
                </ul>
              </div>
            </div>
            <canvas id='beeperLineCanvas' class = 'ideCanvas'></canvas>
         </div>
      </div>
    </div>
    <div style="width:100%;">
        <div class="buttonBar">
           <button class="btn btn-default" id="beeperLineRunButton"><span class="glyphicon glyphicon-play"></span> Run Program</button>
        </div> 
    </div>
<script>

        

function examplebeeperLine() {
STARTER_CODE = `
/*
 * File: BeeperLine.java
 * ------------------------------
 * Uses a "while" loop to place a line of beepers.
 * This program works for a world of any size.
 */
import stanford.karel.*;
public class BeeperLine extends Karel {
   public void run() {
      /* repeats until karel faces a wall */
      while(frontIsClear()) {
         /* place a beeper on current square */ 
         putBeeper();
         /* move to the next square */
         move();
      }
      /* solves the fence-post bug */
      putBeeper();
   }
}`
// because of that extra endline at the start of the string
STARTER_CODE = STARTER_CODE.trim();

 var karelIde = null;
 var karelEditor = null;
 var buttonState = 'play';

 function main() {
   karelEditor = importEditorCode('beeperLineEditor','beeperLineEditorDiv', STARTER_CODE, true);
    setupWorldDropdown();
    
    
    var canvas = document.getElementById('beeperLineCanvas');
    karelIde = KarelIde('java',karelEditor, canvas, '7x7', 0.8, 'en');
    $('#beeperLineRunButton').click(function(){playClicked()});
    onresize();
    
 }

 function setupWorldDropdown() {
    console.log('setup world dropdown')
    let ul = document.getElementById('beeperLineWorlds')
    
    if (!ul.childNodes || ul.childNodes.length == 0) return;

    // Iterate LIs
    for (var itemi=0;itemi<ul.childNodes.length;itemi++) {
        var li = ul.childNodes[itemi];
        if(li.nodeName == "LI") {
          var a = li.childNodes[0]
          let worldName = a.innerHTML;
          console.log(worldName)
          a.onclick = () => setWorld(worldName);

        }
    }
 }

 function setWorld(worldName){
    console.log('here we go', worldName)
    karelIde.changeWorld(worldName)
    changeToPlayButton()
 }

 function playClicked() {
  if(buttonState == 'play') {
    karelIde.playButton();
    changeToResetButton();
   } else if (buttonState == 'reset') {
    karelIde.stopButton();
    changeToPlayButton();
   }
  }

  function changeToPlayButton() {
    var playText = '<span class="glyphicon glyphicon-play"></span> Run Program';
    $('#beeperLineRunButton').html(playText);
    buttonState = 'play';
  }

  function changeToResetButton() {
    var resetText = '<span class="glyphicon glyphicon-repeat"></span> Reset Program';
    $('#beeperLineRunButton').html(resetText);
    buttonState = 'reset';  
  }

 function onresize() { 
    var parentHeight = 352.0;
    var canvasWidth = 300
    var parentWidth = $("#beeperLine").width();
    console.log('pw: ' + parentWidth);

    var ide = document.getElementById('beeperLineIde');
    var editorDiv = document.getElementById('beeperLineEditorDiv');
    var canvas = document.getElementById('beeperLineCanvasDiv');
    
    var ideHeight = parentHeight
    var centerHeight = ideHeight;

    var availibleWidth = parentWidth;
    var elementSpacing = 12;

    var editorWidth = availibleWidth - canvasWidth - elementSpacing; 

    canvas.style.width = canvasWidth + 'px';
    canvas.style.height = canvasWidth + 'px';
    canvas.style.left = (editorWidth + elementSpacing) + 'px';



    editorDiv.style.left = 0 + 'px'
    editorDiv.style.width = editorWidth + 'px';
    editorDiv.style.height = parentHeight + 'px';
    console.log('editor width: ' + editorWidth)

    if (karelEditor) {
       karelEditor.renderer.onResize();
    }
 }
 main()
 
}
examplebeeperLine();
    </script>
</div><hr/>
<center>
  <a class="btn btn-primary btn-lg" href="chapter7.html" role="button">Next Chapter</a>
</center>
</p>

<div style="height:60px"></div>        </div>
      </div>

      </div>
      <!-- right gutter -->
      <div style="flex-grow:4"></div>
    </div>
  </div>
</body> 
</html>
